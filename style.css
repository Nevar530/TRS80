/* ===== Gator Console – style.css (compact, embed-ready) ===== */

/* ---------- Core theme ---------- */
:root {
  --bg: #0b0f14;
  --panel: #121826;
  --ink: #e8eef6;
  --muted: #93a4b8;
  --border: #1f2a3a;

  --bt-amber: #ffd06e;
  --bt-amber-dim: #e0b45c;

  --accent: var(--bt-amber);
  --accent-dim: var(--bt-amber-dim);

  --radius: 8px;
  --transition: 0.2s ease;

  --widget-w: 400px;
  --widget-h: 600px;
  --embed-font: 12.5px;
  --embed-pad: 6px;
  --embed-gap: 6px;

  --vheat-h: 96px; /* vertical heat height (embed override below) */
}

/* ---------- Base reset ---------- */
html, body {
  height: 100%;
  margin: 0;
  background: var(--bg);
  color: var(--ink);
  font-family: ui-sans-serif, system-ui, Segoe UI, Roboto, Arial, sans-serif;
  font-size: 15px;
  line-height: 1.4;
}
button, input, select { font: inherit; color: inherit; }

/* ---------- App layout (only vertical scroll) ---------- */
.app {
  display: flex; flex-direction: column; height: 100%;
  overflow-x: hidden; overflow-y: auto;
}
main.layout { display: flex; flex: 1 0 auto; overflow: visible; }
.col-right { flex: 0 0 auto; padding: 12px; overflow: visible; }

/* ---------- Topbar ---------- */
.ui-topbar {
  display: flex; justify-content: space-between; align-items: center;
  background: var(--panel); border-bottom: 1px solid var(--border); padding: 8px 12px;
}
.brand { display: flex; align-items: center; gap: 6px; font-weight: 600; }
.brand-text { color: var(--accent); }

/* Top actions toolbar */
.actions--top { display:flex; align-items:center; gap:6px; }
.actions--top .btn { padding:4px 8px; font-size:12px; line-height:1; border-radius:6px; }
.divider { width: 1px; height: 20px; background: var(--border); }

/* ---------- Cards / Panels ---------- */
.card, .panel {
  background: var(--panel); border: 1px solid var(--border);
  border-radius: var(--radius); margin-bottom: 12px;
}
.card-h, .panel-h {
  padding: 6px 10px; border-bottom: 1px solid var(--border);
  display: flex; justify-content: space-between; align-items: center;
  font-weight: 600; font-size: 14px;
}
.card-c, .panel-c { padding: 8px 10px; }
.placeholder { color: var(--muted); font-style: italic; font-size: 13px; }

/* ---------- Tabs ---------- */
.tabs { display: flex; gap: 4px; margin-bottom: 8px; }
.tab {
  padding: 6px 10px; background: transparent; border: 1px solid var(--border);
  border-radius: var(--radius); font-size: 13px; cursor: pointer; transition: background var(--transition);
}
.tab.is-active { background: var(--accent-dim); border-color: var(--accent); color: #000; }
.swap-pane { display:none; }
.swap-pane.is-active { display:block; }

/* ---------- Buttons ---------- */
.btn {
  padding: 6px 10px; border-radius: var(--radius); border: 1px solid var(--border);
  background: var(--accent-dim); color: #000; cursor: pointer; transition: background var(--transition);
}
.btn:hover { background: var(--accent); }
.btn.ghost { background: transparent; color: var(--ink); }
.btn.ghost:hover { background: var(--border); }
.btn.sm { padding: 4px 8px; font-size: 13px; }

/* ---------- Vertical Heat (Overview) ---------- */
.overview-flex{ display:flex; gap:10px; align-items:stretch; }
.vheat{ width: 28px; display:flex; flex-direction:column; align-items:center; gap:4px; }
.vheat-bar{ position:relative; width: 12px; height: var(--vheat-h); background: var(--border); border-radius: 6px; overflow:hidden; box-shadow: inset 0 0 0 1px rgba(0,0,0,0.15); }
.vheat-bar::after{ content:""; position:absolute; inset:0; pointer-events:none;
  background: repeating-linear-gradient(to top, transparent 0, transparent calc(10% - 1px), rgba(0,0,0,0.45) calc(10% - 1px), rgba(0,0,0,0.45) 10%);
  mix-blend-mode:multiply;
}
.vheat-fill{ position:absolute; left:0; bottom:0; width:100%; height:0%; background: var(--accent); transition: height var(--transition); }
.vheat-legend{ font-size:11.5px; color:var(--muted); }
.overview-grid { display:grid; grid-template-columns:1fr 1fr; gap:6px 8px; flex:1; }
.overview-grid label { display:block; font-size:11px; color:var(--muted); margin-bottom:2px; }

/* ---------- Tech Readout ---------- */
.tro-grid { display:grid; grid-template-columns:1fr 1fr; gap:8px; }
.fullw { width:100%; border-collapse:collapse; margin-top:6px; }
.fullw th, .fullw td { padding:6px 0; text-align:left; }
.mt6 { margin-top:6px; }

/* ===================== GATOR (COMPACT) ===================== */
.gtr-compact{ display:flex; flex-direction:column; gap:8px; }
.gtr-columns{ display:grid; grid-template-columns:1fr 1fr; gap:8px; }
.gtr-col{ background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(0,0,0,.02));
  border:1px solid var(--border); border-radius:8px; padding:8px; display:flex; flex-direction:column; gap:6px; }
.gtr-title{ font-size:12px; font-weight:700; color:var(--muted); display:flex; align-items:center; gap:6px; }
.dot{ width:10px; height:10px; border-radius:10px; display:inline-block; }
.dot-att{ background:#8ad; } .dot-tgt{ background:#d88; }

.gtr-lab{ font-size:11.5px; color:var(--muted); }
.gtr-sel{ width:100%; padding:6px 8px; border-radius:6px; border:1px solid var(--border); background:#0e1522; color:var(--ink); }
.gtr-sel.xs{ width:auto; min-width:170px; }
.gtr-sel.tiny{ width:70px; }

.gtr-in.tiny{ width:64px; padding:6px 8px; border-radius:6px; border:1px solid var(--border); background:#0e1522; color:var(--ink); text-align:center; }

.gtr-toggles{ display:flex; flex-wrap:wrap; gap:8px 10px; align-items:center; font-size:12px; color:var(--muted); }
.chk input{ vertical-align:middle; margin-right:4px; }

.gtr-rows{ display:flex; flex-direction:column; gap:8px; }
.gtr-row{ display:grid; grid-template-columns:110px 1fr; gap:8px; align-items:center; }
.gtr-groups{ display:flex; flex-wrap:wrap; gap:6px; }

.gtr-roller{ display:flex; align-items:center; gap:6px; }
.icon-btn{ border:0; background:transparent; padding:6px; width:32px; height:32px; border-radius:6px; cursor:pointer; }
.result-badge{ min-width:44px; text-align:center; padding:6px 8px; border-radius:999px; background:rgba(255,255,255,0.04); font-weight:800; font-size:13px; }

.gtr-footer{ display:flex; align-items:center; gap:10px; border-top:1px solid var(--border); padding-top:8px; }
.gtr-tn{ margin-right:auto; }
.tn{ font-weight:900; font-size:20px; }
.tn-auto{ color:lime; } .tn-yellow{ color:yellow; } .tn-red{ color:#ff6b6b; }

/* Segmented buttons (Range) */
.gtr-seg{ display:inline-flex; flex-wrap:nowrap; border:1px solid var(--border); border-radius:6px; overflow:hidden; }
.gtr-seg button{
  border:0; background:#0e1522; color:var(--ink);
  padding:4px 8px; font-size:12px; line-height:1; cursor:pointer;
}
.gtr-seg button + button{ border-left:1px solid var(--border); }
.gtr-seg button.is-active{ background:var(--accent-dim); color:#000; }

/* ---------- Toast ---------- */
.toast {
  position: fixed; bottom: 12px; right: 12px;
  background: var(--panel); border: 1px solid var(--accent);
  border-radius: var(--radius); padding: 8px 12px; font-size: 14px;
  display: none;
}
.toast[hidden] { display: none; }

/* ---------- Footer ---------- */
.app-footer{
  margin-top: auto;
  background: var(--panel);
  border-top: 1px solid var(--border);
  padding: 6px 10px;
}
.app-footer-row{ display:flex; gap:8px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
.app-footer .sep{ opacity:.5; }
.linklike{ background:transparent; border:0; color: var(--accent); cursor:pointer; text-decoration:underline; padding:0 2px; }

/* ---------- Modal ---------- */
.modal[hidden]{ display:none; }
.modal{ position: fixed; inset:0; display:flex; align-items:center; justify-content:center; background: rgba(0,0,0,0.5); z-index: 1000; }
.modal-card{
  width: min(640px, 92vw);
  background: var(--panel); border:1px solid var(--border); border-radius: 10px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.45);
}
.modal-h{ display:flex; align-items:center; justify-content:space-between; padding:10px 12px; border-bottom:1px solid var(--border); }
.modal-c{ padding:12px; }
.modal-f{ padding:10px 12px; border-top:1px solid var(--border); display:flex; justify-content:flex-end; }
.modal-divider{ border:0; border-top:1px solid var(--border); margin:10px 0; }

/* ---------- Utility ---------- */
.mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
.dim { color: var(--muted); }
.small { font-size: 12.5px; }
.noscript { padding: 20px; background: #600; color: #fff; font-weight: bold; text-align: center; }

/* ===== EMBED MODE (tiny widget) ===== */
.app.is-embed{
  width: var(--widget-w);
  height: var(--widget-h);
  max-width: 100%;
  max-height: 100%;
  border: 1px solid var(--border);
  border-radius: 10px;
  overflow-x: hidden; overflow-y: auto;
  background: var(--panel);
  box-shadow: 0 8px 24px rgba(0,0,0,0.35);
  font-size: var(--embed-font);
  line-height: 1.25;
}
.app.is-embed .ui-topbar { padding: var(--embed-pad) var(--embed-pad); }
.app.is-embed .btn { padding: 4px 8px; }
.app.is-embed main.layout { flex-direction: column; }
.app.is-embed .col-right { padding: var(--embed-pad); }
.app.is-embed .card, .app.is-embed .panel { margin-bottom: var(--embed-gap); }
.app.is-embed .card-h, .app.is-embed .panel-h { padding: 4px 6px; }
.app.is-embed .card-c, .app.is-embed .panel-c { padding: 6px; }
.app.is-embed #top-swapper .tab { padding: 3px 6px; font-size: 12px; }
.app.is-embed .toast { position: absolute; bottom: 8px; right: 8px; font-size: 12px; padding: 6px 8px; }

/* ===== Narrow/Embed clamps for GATOR ===== */
.app.is-embed #pane-gator .gtr-columns{ grid-template-columns:1fr !important; }
.app.is-embed #pane-gator .gtr-row{ grid-template-columns:1fr !important; }
.app.is-embed #pane-gator .gtr-compact{ gap:6px; }
.app.is-embed #pane-gator .gtr-col{ padding:6px; }

/* Search dropdown */
#search-results{
  position:absolute; z-index:9999; pointer-events:auto; max-height:300px; overflow:auto;
  background: rgba(0,0,0,.8);
  border:1px solid var(--border); border-radius:6px;
}
#search-results .result-item{
  display:block; width:100%; padding:.4rem .6rem; cursor:pointer; user-select:none;
  transition:background var(--transition), color var(--transition);
}
#search-results .result-item:hover,
#search-results .result-item:focus{
  background: var(--bt-amber) !important; color:#000 !important;
}
#search-results .result-item:hover .result-variant,
#search-results .result-item:focus .result-variant{ color:#222 !important; }

/* ===== GATOR sub-tabs (G, A, T, O, R, Dice/TN) ===== */
.gtr-subtabs{ display:flex; gap:6px; margin-bottom:6px; }
.gtr-subtab{
  padding:4px 8px; font-size:12px; line-height:1;
  background:transparent; border:1px solid var(--border); border-radius:6px; cursor:pointer;
}
.gtr-subtab.is-active{ background:var(--accent-dim); color:#000; border-color:var(--accent); }
.gtr-pane{ display:none; }
.gtr-pane.is-active{ display:block; }

/* keep panes compact inside widget */
#pane-gator .card-c{ overflow:visible; }

/* Tech Readout layout helpers */
.tr-compact .tro-grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
}

.fullw{ width:100%; border-collapse:collapse; }
.fullw th, .fullw td{ padding:6px 0; text-align:left; }

.mt6{ margin-top:6px; }

/* keep consistency with GATOR subtabs (already defined);
   no extra styles needed unless you want a unique look */

/* Hide scrollbars globally inside the app, keep scrolling */
.app, .app * {
  -ms-overflow-style: none;   /* IE/old Edge */
  scrollbar-width: none;      /* Firefox */
}
.app *::-webkit-scrollbar {
  width: 0;
  height: 0;
  display: none;              /* Chrome/Safari/new Edge */
}

/* Optional: smoother feel + no browser bounce chaining */
.app {
  overscroll-behavior: contain;
}

/* If any panel forces scrollbars via 'overflow: scroll', switch to auto */
.swap-pane, .gtr-pane, .card-c {
  overflow: auto;             /* scrolls when needed, bar stays hidden */
}


/* Filter modal tweaks (optional) */
#filter-modal .gtr-in.tiny { width:100%; }
#filter-modal .chk { user-select:none; }

#btn-roll-att, #btn-roll-both { background: var(--bt-amber); color:#000; font-weight:400; }

/* Icon-only buttons */
.btn.icon {
  padding: 4px;          /* tighter padding */
  width: 28px;           /* fixed square */
  height: 28px;
  font-size: 16px;       /* scale emoji/arrow */
  display: inline-flex;  
  align-items: center;   
  justify-content: center;
}

/* ===== Sidebar layout ===== */
main.layout {
  display: grid;
  grid-template-columns: 280px 1fr; /* sidebar + main */
  gap: 12px;
}

/* Sidebar container */
.col-left {
  padding: 12px;
  overflow: hidden; /* keep panel-rounded edges clean */
}

/* Make the list area scroll independently */
#mech-sidebar .panel {
  display: flex;
  flex-direction: column;
  height: calc(100vh - 140px); /* heuristic so it fits under the topbar */
  max-height: calc(100vh - 140px);
}

#mech-sidebar .panel-h {
  position: sticky;
  top: 0;
  z-index: 1;
  background: var(--panel);
  border-bottom: 1px solid var(--border);
}

#side-search {
  flex: 1 1 auto;
  min-width: 0;
  padding: 6px 8px;
  border-radius: 6px;
  border: 1px solid var(--border);
  background: #0e1522;
  color: var(--ink);
}

/* Scrollable list */
#mech-list {
  overflow-y: auto;
  height: 100%;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: rgba(0,0,0,0.05);
}

/* List rows (lightweight) */
.mech-row {
  padding: 6px 8px;
  border-bottom: 1px solid var(--border);
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 6px;
  line-height: 1.2;
}
.mech-row:last-child { border-bottom: 0; }

.mech-row:hover,
.mech-row:focus {
  background: var(--accent-dim);
  color: #000;
  outline: none;
}

.mech-row .name {
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

.mech-row .variant {
  margin-left: auto;
  opacity: .6;
  font-size: 12px;
}

/* ===== Embed tweaks ===== */
.app.is-embed {
  /* give the widget more width to fit a sidebar nicely */
  --widget-w: 720px; /* was 400px */
}
.app.is-embed main.layout {
  grid-template-columns: 240px 1fr; /* a bit narrower in embed */
}

.mech-row.is-active {
  background: var(--accent-dim);
  color: #000;
}

/* Layout: right now main.layout is already display:flex */
.col-left{
  flex: 0 0 280px;           /* sidebar width */
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 12px;
}

/* header (search + buttons) stays visible, list scrolls under it */
.mech-list-h{
  position: sticky;
  top: 0;
  background: var(--panel);
  z-index: 1;
  padding-bottom: 6px;
  border-bottom: 1px solid var(--border);
}

/* this is the scrollable area */
.mech-list-body{
  flex: 1 1 auto;
  overflow: auto;            /* ✅ scrollable */
  border: 1px solid var(--border);
  border-radius: var(--radius);
}

/* Sidebar column */
.col-left {
  flex: 0 0 280px;        /* fixed width for sidebar */
  display: flex;
  flex-direction: column;
  padding: 12px;
}

/* Panel body is the scroll container */
#mech-list {
  max-height: calc(100vh - 120px); /* prevent it from growing too tall */
  overflow-y: auto;                /* ✅ scrolling enabled */
  border: 1px solid var(--border);
  border-radius: var(--radius);
}

/* Optional: give visible scrollbars here, since the app hides them globally */
#mech-list {
  scrollbar-width: auto;             /* Firefox */
}
#mech-list::-webkit-scrollbar {      /* Chromium/WebKit */
  width: 8px;
}
#mech-list::-webkit-scrollbar-thumb {
  background: var(--border);
  border-radius: 4px;
}

/* ===== Sidebar sizing (desktop default) ===== */
.col-left {
  width: 280px;            /* tweak as you like */
  flex: 0 0 auto;
  padding: 12px;
}

/* Sidebar content */
#mech-sidebar .panel { height: calc(100vh - 96px); /* topbar + padding budget */ }
#mech-sidebar .panel-c { padding: 0; }
#mech-sidebar #mech-list {
  max-height: calc(100vh - 96px - 44px); /* subtract panel header */
  overflow: auto;
}

/* Scrim base */
#sidebar-scrim {
  position: fixed; inset: 0;
  background: rgba(0,0,0,.45);
  z-index: 998;
}

/* ===== Mobile: turn sidebar into a sliding drawer ===== */
@media (max-width: 800px) {
  /* app width goes full; sidebar overlays instead of taking layout space */
  .layout { position: relative; }

  .col-left {
    position: fixed;
    top: 46px;               /* height of topbar; adjust if yours differs */
    left: 0;
    bottom: 0;
    width: min(86vw, 320px);
    padding: 8px;
    z-index: 999;            /* above content, below modal */
    transform: translateX(-100%);
    transition: transform var(--transition);
  }

  .col-left.is-open {
    transform: translateX(0);
  }

  /* hide scrim by default; shown by JS when open */
  #sidebar-scrim[hidden] { display: none; }
}

/* Optional: hide the hamburger on wide screens */
@media (min-width: 801px) {
  #btn-side-toggle { display: none; }
}

/* === Main two-column layout === */
main.layout { display: flex; }
.col-left  { flex: 0 0 280px; max-width: 320px; padding: 12px; }
.col-right { flex: 1 1 auto; min-width: 0; padding: 12px; }

/* Make the mech list actually scroll without overlapping */
#mech-sidebar .panel { height: calc(100vh - 96px); } /* tweak 96px if your topbar height differs */
#mech-sidebar .panel-c { padding: 0; }
#mech-list { max-height: calc(100vh - 96px - 44px); overflow: auto; }

/* === Topbar: keep on one line === */
.ui-topbar { display: flex; align-items: center; justify-content: space-between; flex-wrap: nowrap; }
.topbar-left, .topbar-right { display: flex; align-items: center; gap: 6px; min-width: 0; }
.actions--top { display: flex; align-items: center; gap: 6px; flex-wrap: nowrap; }
.actions--top > * { flex: 0 0 auto; }
